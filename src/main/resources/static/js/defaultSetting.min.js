const authPathArr = [
	"myprofile.html", "maptrip.html", "index.html"
];
const notAuthPathArr = [
	"signin.html", "signup.html", "findpw.html", "findId.html", "maptrip.html", "index.html"
];


function setNav($el) {
	$el.innerHTML = `<li><a href="maptrip.html">지역별관광지</a></li>
		<li><a href="index.html">나의여행계획</a></li>
		<li><a href="index.html">핫플자랑하기</a></li>
		<li><a href="index.html">여행정보공유</a></li>${$.cookie("name") != null
			? "<li><a href='myprofile.html'>내 프로필</a></li><li><a class='logout'>로그아웃</a></li>"
			: '<li><a href="signup.html">회원가입</a></li><li><a href="signin.html">로그인</a></li>'
		}`;
}


window.onload = function() {
	const $navBar = document.querySelector(".js-clone-nav");
	const $navWrap = document.querySelector(".site-nav-wrap");
	const curPathArr = window.location.pathname.split("/");
	const curPath = curPathArr[2];

//	//로그인 상태와, 비 로그인 상태일때 각각의 상태에서 들어가면 안되는 경로에 들어갔을 때는 index.html로 강제 redirect 시킴
//	if (($.cookie("name") && !authPathArr.includes(curPath)) || (!$.cookie("name") && !notAuthPathArr.includes(curPath))) {
//		location.replace("index.html");
//		alert("올바르게 사이트를 이용해주세요!");
//	}

	if ($navBar) setNav($navBar);
	if ($navWrap) setNav($navWrap);

	const $logoutBtns = document.querySelectorAll(".logout");

	if ($logoutBtns) {
		$logoutBtns.forEach(($curBtn) => {
			$curBtn.addEventListener("click", () => {
				console.log("요기");
				$.removeCookie("name");
				location.replace("index.html");
			})
		})
	}
};

async function logout() {
	$.removeCookie("name");
	await fetch("main", { method: "post", body: JSON.stringify({ sign: "logout" }) });
	location.replace("index.html");
}

function processError(error) {
	const errorArr = error.message.split(":");
	if (errorArr[0][0] === "2") {
		errorArr.shift();
		alert(errorArr.join(""));
	} else {
		location.replace("error.html");
	}
}